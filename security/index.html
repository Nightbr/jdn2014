<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">

        <title>Sécurité - jdnApp</title>

        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../css/prettify-1.0.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="..">jdnApp</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="..">Home</a>
                    </li>
                
                
                
                    <li >
                        <a href="../installation/">Installation</a>
                    </li>
                
                
                
                    <li class="active">
                        <a href="./">Sécurité</a>
                    </li>
                
                
                
                    <li >
                        <a href="../api/">API</a>
                    </li>
                
                
                
                    <li >
                        <a href="../admin/">Admin</a>
                    </li>
                
                
                
                    <li >
                        <a href="../howto/">How-to</a>
                    </li>
                
                
                </ul>
            

            
            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                
                <li >
                    <a rel="next" href="../installation/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../api/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                
                <li>
                    <a href="https://github.com/Nightbr/jdn2014">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
            
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#securite">Sécurité</a></li>
        
            <li><a href="#api-rest">API Rest</a></li>
        
            <li><a href="#panel-admin">Panel admin</a></li>
        
            <li><a href="#comptes-utilisateurs-par-defaut">Comptes utilisateurs par défaut</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="securite">Sécurité</h1>
<h2 id="api-rest">API Rest</h2>
<h3 id="authentification">Authentification</h3>
<p>L'API utilise la méthode Basic Auth pour gérer les utilisateurs qui y ont accés.
L'utilisateur de l'API a un rôle <strong>api</strong>.</p>
<p>Les utilisateurs sont enregistrés dans la base de données et peuvent être géré depuis le panel Admin.</p>
<p>Il est conseillé de changer le mot de passe par defaut des utilisateurs après la mise en ligne de l'application.</p>
<h3 id="securite_1">Sécurité</h3>
<p>Il se trouve que toutes les actions ne sont pas possible pour des raisons de sécurités. En effet, il n'est pas possible de supprimer une catégorie ou un guest depuis l'API, on doit passer par le panel Admin.</p>
<p>Mais on peut choisir ce qu'on souhaite avoir comme action via le fichier <code>routes.php</code> qui se trouve dans le dossier <code>api/laravel/app</code> :</p>
<pre class="prettyprint well"><code>/* Groupe de routes pour le versioning d'API */
Route::group(array('prefix' =&gt; 'v1', 'before' =&gt; 'auth.basic'), function()
{
    Route::resource('categorie', 'CategorieController', array('only' =&gt; array('index', 'show', 'showGuest')));
    Route::get("categorie/{id}/guest", array("uses" =&gt; "CategorieController@showGuest"));
    Route::resource('table', 'TableController', array('only' =&gt; array('index', 'show', 'showGuest')));
    Route::get("table/{id}/guest", array("uses" =&gt; "TableController@showGuest"));
    Route::resource('guest', 'GuestController', array('only' =&gt; array('index', 'show', 'store')));
});
</code></pre>
<p>Grâce au paramètre <code>only</code> on peut définir un tableau avec les actions voulues.</p>
<h3 id="acces-a-lapi">Accès à l'API</h3>
<p>Voici un exemple de JavaScript pour s'authentifier à l'API :</p>
<pre class="prettyprint well"><code>var api_url = "http://localhost/jdn2014/app/api/laravel/public/v1/";
var username = "apiuser1";
var password = "gogogo";
var api_key = btoa(username + ":" + password);


//login api
$.ajax({
    url: api_url+"categorie/1",
    type: 'get',
    //username: username,
    //password: password,
    headers: {
       "Authorization": "Basic " + api_key
    },
    success: function()
    {
      //code de l'application
    }
});
</code></pre>
<p>Pour plus de sécurité et ne pas avoir l'username et le password dans le code, on peut juste remplacer <code>api_key</code> par sa valeur en générant un requête avec Postman par exemple et en récupérant simplement le token du Basic Auth.</p>
<h2 id="panel-admin">Panel admin</h2>
<p>Pour accéder au panel d'adminstration, il faut disposer d'un compte utilisateur disposant du rôle <strong>admin</strong>.</p>
<p>Il est conseillé de changer le mot de passe par defaut des utilisateurs après la mise en ligne de l'application.</p>
<h2 id="comptes-utilisateurs-par-defaut">Comptes utilisateurs par défaut</h2>
<p>Voici les comptes utilisateurs par défaut dans la base de données lors d'une nouvelle installation de l'application :</p>
<pre class="prettyprint well"><code>User::create(array(
  'username' =&gt; 'adminjdn',
  'password' =&gt; 'jdnadmindede',
  'email'    =&gt; 'dede@example.com',
  'role'     =&gt; 'admin'
));

User::create(array(
  'username' =&gt; 'apiuser1',
  'password' =&gt; 'gogogo',
  'email'    =&gt; 'roo@example.com',
  'role'     =&gt; 'api'
));
</code></pre>
<p>Soit pour le panel Admin <code>http://localhost/jdn2014/app/api/laravel/public/admin</code> :</p>
<ul>
<li>utilisateur : adminjdn</li>
<li>mot de passe : jdnadmindede</li>
</ul>
<p>Soit pour l'api <code>http://localhost/jdn2014/app/api/laravel/public/v1</code> :</p>
<ul>
<li>utilisateur : apiuser1</li>
<li>mot de passe : gogogo</li>
</ul>
</div>
        </div>

        <footer class="col-md-12">
            <hr>
            
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        

        <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/prettify-1.0.min.js"></script>
        <script src="../js/base.js"></script>
        
    </body>
</html>